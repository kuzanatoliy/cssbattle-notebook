<!DOCTYPE html>
<html lang="en">
  <head>
    <script>
      class BattlePreview extends HTMLElement {
        #shadow;
        #style;

        constructor() {
          super();
          this.#shadow = this.attachShadow({ mode: "open" });

          this.#style = document.createElement("style");
          this.#style.textContent = `
            :host {
              display: block;
            }

            @keyframes skeleton {
              0% {
                opacity: 1;
              }

              50% {
                opacity: 0.4;
              }

              100% {
                opacity: 1;
              }
            }

            .loading-skeleton {
              height: 100%;
              width: 100%;
              background: #EAEAEA;
              animation: 3s infinite alternate skeleton;
            }
          `;
          console.log(this.attributes);

          this.#shadow.appendChild(this.#style);
        }

        connectedCallback() {
          if (this.attributes.src) {
            console.log("called");
            fetch(this.getAttribute("src"))
              .then(() => console.log("called"))
              .catch(() => console.log("called"));
          }

          //this.#loadingSkeleton = document.createElement("div");
          //this.#loadingSkeleton.setAttribute("class", "loading-skeleton");

          console.log(this.attributes);
        }

        attributeChangedCallback(name, oldValue, newValue) {
          console.log(name, oldValue, newValue);
        }
      }

      customElements.define("battle-preview", BattlePreview);
    </script>
    <style>
      battle-preview {
        height: 300px;
        width: 400px;
      }
    </style>
  </head>
  <body>
    <battle-preview src="https://cssbattle.dev/targets/1.png" />
  </body>
</html>
